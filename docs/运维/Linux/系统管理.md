# 系统管理

---

## 进程与服务

- **进程(process)** : 一个正在执行的程序或命令。
- **服务(service)** : 启动之后一直存在、常驻内存的进程。 
- **系统服务** : 系统运行所需要的服务。
- **守护进程(daemon)** : 具体执行 **系统服务** 的进程

## service 命令(CentOS6)

### 基本语法

`service 服务名 start|stop|restart|status`

### 查看所有服务

- CentOS 6 版本中，在 `/etc/init.d`  目录下保存了 service 命令可以操作的所有服务。
- 我们看到这里服务其实只有 netconsole 和 network (它们都是可执行文件) ，因为 CentOS 7 做了改动，改用 systemctl 命令，但仍兼容了 service 命令。

````sh
[root@start100 ~]# cd /etc/init.d/
[root@start100 init.d]# ls -a
.  ..  functions  netconsole  network  README
````

## systemctl 命令(CentOS7)

### 基本语法

- 即 `system control`

`systemctl start|stop|restart|status 服务名` 

### 查看所有服务

- CentOS 7 版本中，在 `/usr/lib/systemd/system` 目录下有着各种系统服务

  ```sh
  [root@start100 init.d]# ls /usr/lib/systemd/system
  abrt-ccpp.service                        plymouth-quit-wait.service
  abrtd.service                            plymouth-read-write.service
  abrt-oops.service                        plymouth-reboot.service
  abrt-pstoreoops.service                  plymouth-start.service
  abrt-vmcore.service                      plymouth-switch-root.service
  ........
  ```

## setup

- 执行 `setup` 命令 可以进入图形化设置界面。

  ![image-20220725232242236](系统管理/image-20220725232242236.png)

- 选择 `System services` 可以进入系统服务配置界面，这个界面可以配置 **开机自启** 的 **服务** 。

  ![image-20220725232340412](系统管理/image-20220725232340412.png)

- 有 `*` 表示勾选，没有代表未勾选；按下空格键可以 **勾选** 或 **取消勾选** 。

- `SysV initscripts` 是 CentOS 6版本的; `systemd services` 是 CentOS 7 版本的。

## 系统运行级别

### Linux启动步骤

![image-20220725234153199](系统管理/image-20220725234153199.png)

### 运行级别(CentOS6)

- 级别越高，支持的功能越丰富(6除外) 。
- Linux 系统有 7 种运行级别(runlevel)，常用的是 3 和 5 。
- 不同的运行级别，本质上就是开机自动启动的服务不同。

| 运行级别 | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| 0        | 系统 **停机状态** ; 系统 **默认运行级别** 不能设置为 0，否则无法正常启动 |
| 1        | **单用户** 工作状态; **root 权限** ; 用于 **系统维护** ; 禁止远程登录 |
| 2        | **多用户** 工作状态; 没有 **NFS(Network File System 网络文件系统)** ; 不支持网络 |
| 3        | **完全的多用户** 工作状态; 有 **NFS** ; 登录后进入 **命令行模式** |
| 4        | 系统未使用，保留                                             |
| 5        | X11 控制台，登录后进入图形GUI模式                            |
| 6        | 系统 **正常关闭并重启** ; 系统 **默认运行级别** 不能设置为 6，否则无法正常启动 |

### 运行级别(CentOS7)

由于运行级别 3 和 5 是最常用的，所以 CentOS7对运行级别进行了简化。

- `multi-user.target` 等价于原运行级别 3（多用户有网，无图形界面）
- `graphical.target` 等价于原运行级别 5（多用户有网，有图形界面）

### 运行级别命令(CentOS6)

#### 查看默认运行级别

- 在文件 `/etc/inittab` ，CentOS7已弃用。

#### 设置当前运行级别

- 执行 `init 3` / `init 5` 可以立即更换系统运行级别

### 运行级别命令(CentOS7)

#### 查看默认运行级别

- `systemctl get-default`

  ```sh
  [root@start100 ~]# systemctl get-default
  graphical.target
  ```

#### 设置默认运行级别

- `systemctl set-default multi-user.target` / `systemctl set-default graphical.target` 
- 重启系统生效。



---

**参考：**

1. 尚硅谷官方课程。
